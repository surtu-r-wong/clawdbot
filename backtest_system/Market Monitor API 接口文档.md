Market Monitor API 接口文档

  基础地址: http://100.75.102.44:8000
  API 文档: http://100.75.102.44:8000/docs
  认证方式: Bearer Token（写入接口需要）
  Token: Market_Monitor_Secret_Key_2024

  ---
  一、系统接口
  ┌──────┬─────────┬────────────────────────────────────┐
  │ 方法 │  路径   │                说明                │
  ├──────┼─────────┼────────────────────────────────────┤
  │ GET  │ /       │ 根路径，返回系统信息和支持的表列表 │
  ├──────┼─────────┼────────────────────────────────────┤
  │ GET  │ /health │ 健康检查，检测数据库连接状态       │
  └──────┴─────────┴────────────────────────────────────┘
  ---
  二、数据写入接口（需认证）

  2.1 日频数据写入

  接口: POST /api/data/daily

  请求头:
  Authorization: Bearer Market_Monitor_Secret_Key_2024
  Content-Type: application/json

  请求体:
  {
    "table": "表名",
    "data": [{ ... }, { ... }]
  }

  支持的表:
  ┌─────────────────────────────┬──────────────┐
  │            表名             │     说明     │
  ├─────────────────────────────┼──────────────┤
  │ futures_daily               │ 期货日线     │
  ├─────────────────────────────┼──────────────┤
  │ stock_daily                 │ 股票日线     │
  ├─────────────────────────────┼──────────────┤
  │ option_daily                │ 期权日线     │
  ├─────────────────────────────┼──────────────┤
  │ bond_daily                  │ 债券日线     │
  ├─────────────────────────────┼──────────────┤
  │ futures_contract_info       │ 期货合约信息 │
  ├─────────────────────────────┼──────────────┤
  │ futures_contracts_all       │ 期货合约列表 │
  ├─────────────────────────────┼──────────────┤
  │ futures_account             │ 期货账户     │
  ├─────────────────────────────┼──────────────┤
  │ futures_position            │ 期货持仓     │
  ├─────────────────────────────┼──────────────┤
  │ futures_transaction_details │ 期货交易明细 │
  ├─────────────────────────────┼──────────────┤
  │ stock_account               │ 股票账户     │
  ├─────────────────────────────┼──────────────┤
  │ stock_position              │ 股票持仓     │
  ├─────────────────────────────┼──────────────┤
  │ stock_transaction_details   │ 股票交易明细 │
  ├─────────────────────────────┼──────────────┤
  │ spot_prices                 │ 现货价格     │
  ├─────────────────────────────┼──────────────┤
  │ inventory                   │ 库存数据     │
  ├─────────────────────────────┼──────────────┤
  │ spreads                     │ 价差数据     │
  ├─────────────────────────────┼──────────────┤
  │ position_table              │ 头寸持仓     │
  ├─────────────────────────────┼──────────────┤
  │ position_close_table        │ 平仓记录     │
  └─────────────────────────────┴──────────────┘
  2.2 分钟数据写入

  接口: POST /api/data/minute

  ---
  三、行情数据查询接口

  3.1 通用查询
  ┌──────┬──────────────────────────┬──────────────────┐
  │ 方法 │           路径           │       说明       │
  ├──────┼──────────────────────────┼──────────────────┤
  │ GET  │ /api/data/daily/{symbol} │ 查询指定品种日线 │
  ├──────┼──────────────────────────┼──────────────────┤
  │ GET  │ /api/data/symbols        │ 获取所有品种列表 │
  └──────┴──────────────────────────┴──────────────────┘
  /api/data/daily/{symbol} 参数:
  - symbol (路径参数): 品种代码
  - start_date: 开始日期
  - end_date: 结束日期
  - limit: 返回条数，默认1000

  3.2 期货数据
  ┌──────┬───────────────────────────────┬──────────────────┐
  │ 方法 │             路径              │       说明       │
  ├──────┼───────────────────────────────┼──────────────────┤
  │ GET  │ /api/futures/daily            │ 批量查询期货日线 │
  ├──────┼───────────────────────────────┼──────────────────┤
  │ GET  │ /api/futures/daily/latest     │ 获取最新期货日线 │
  ├──────┼───────────────────────────────┼──────────────────┤
  │ GET  │ /api/continuous/{base_symbol} │ 查询连续合约     │
  ├──────┼───────────────────────────────┼──────────────────┤
  │ GET  │ /api/futures/contract-info    │ 查询期货合约信息 │
  ├──────┼───────────────────────────────┼──────────────────┤
  │ GET  │ /api/futures/contracts        │ 查询期货合约列表 │
  └──────┴───────────────────────────────┴──────────────────┘
  /api/futures/daily 参数:
  - symbols: 合约代码，逗号分隔，支持通配符如 RB%
  - start_date: 开始日期
  - end_date: 结束日期
  - limit: 返回条数，默认10000，最大50000

  /api/futures/daily/latest 参数:
  - trade_date: 指定日期，不传则返回最新日期

  /api/futures/contract-info 参数:
  - symbol: 合约代码
  - product: 品种代码
  - trade_date: 交易日期
  - limit: 返回条数

  /api/futures/contracts 参数:
  - variety: 品种代码
  - exchange: 交易所代码
  - limit: 返回条数

  3.3 股票数据
  ┌──────┬──────────────────┬──────────────────┐
  │ 方法 │       路径       │       说明       │
  ├──────┼──────────────────┼──────────────────┤
  │ GET  │ /api/stock/daily │ 批量查询股票日线 │
  └──────┴──────────────────┴──────────────────┘
  参数:
  - symbols: 股票代码，逗号分隔，支持通配符如 600%
  - start_date, end_date, limit

  3.4 期权数据
  ┌──────┬───────────────────┬──────────────────┐
  │ 方法 │       路径        │       说明       │
  ├──────┼───────────────────┼──────────────────┤
  │ GET  │ /api/option/daily │ 批量查询期权日线 │
  └──────┴───────────────────┴──────────────────┘
  参数: symbols, start_date, end_date, limit

  3.5 债券数据
  ┌──────┬─────────────────┬──────────────────┐
  │ 方法 │      路径       │       说明       │
  ├──────┼─────────────────┼──────────────────┤
  │ GET  │ /api/bond/daily │ 批量查询债券日线 │
  └──────┴─────────────────┴──────────────────┘
  参数: symbols, start_date, end_date, limit

  3.6 分钟数据
  ┌──────┬──────────────────┬──────────────┐
  │ 方法 │       路径       │     说明     │
  ├──────┼──────────────────┼──────────────┤
  │ GET  │ /api/data/minute │ 查询分钟数据 │
  └──────┴──────────────────┴──────────────┘
  参数: symbol, start_time, end_time, limit

  ---
  四、账户持仓查询接口

  4.1 期货账户
  ┌──────┬───────────────────────────┬──────────────────┐
  │ 方法 │           路径            │       说明       │
  ├──────┼───────────────────────────┼──────────────────┤
  │ GET  │ /api/futures/account      │ 查询期货账户     │
  ├──────┼───────────────────────────┼──────────────────┤
  │ GET  │ /api/futures/position     │ 查询期货持仓     │
  ├──────┼───────────────────────────┼──────────────────┤
  │ GET  │ /api/futures/transactions │ 查询期货交易明细 │
  └──────┴───────────────────────────┴──────────────────┘
  /api/futures/account 参数:
  - account_no: 账号
  - trade_date: 交易日期
  - start_date, end_date, limit

  /api/futures/position 参数:
  - account_no: 账号
  - contract_code: 合约代码
  - trade_date: 交易日期
  - limit

  /api/futures/transactions 参数:
  - account_no: 账号
  - contract_code: 合约代码
  - trade_date, start_date, end_date, limit

  4.2 股票账户
  ┌──────┬─────────────────────────┬──────────────────┐
  │ 方法 │          路径           │       说明       │
  ├──────┼─────────────────────────┼──────────────────┤
  │ GET  │ /api/stock/account      │ 查询股票账户     │
  ├──────┼─────────────────────────┼──────────────────┤
  │ GET  │ /api/stock/position     │ 查询股票持仓     │
  ├──────┼─────────────────────────┼──────────────────┤
  │ GET  │ /api/stock/transactions │ 查询股票交易明细 │
  └──────┴─────────────────────────┴──────────────────┘
  参数: capital_account, security_code, trade_date, start_date, end_date, limit

  4.3 头寸持仓（position_table）
  ┌──────┬───────────────┬──────────────────┐
  │ 方法 │     路径      │       说明       │
  ├──────┼───────────────┼──────────────────┤
  │ GET  │ /api/position │ 查询头寸持仓记录 │
  └──────┴───────────────┴──────────────────┘
  参数:
  - trade_date: 交易日期
  - account_name: 账号名称
  - position_name: 头寸名称
  - symbol: 标的代码
  - start_date: 开始日期
  - end_date: 结束日期
  - limit: 返回条数（默认1000，最大10000）

  返回字段:
  ┌──────────┬───────────────┐
  │   字段   │     说明      │
  ├──────────┼───────────────┤
  │ 交易日期 │               │
  ├──────────┼───────────────┤
  │ 账号名称 │               │
  ├──────────┼───────────────┤
  │ 资产类别 │ futures/stock │
  ├──────────┼───────────────┤
  │ 头寸类别 │ 对冲/单边等   │
  ├──────────┼───────────────┤
  │ 头寸名称 │               │
  ├──────────┼───────────────┤
  │ 标的代码 │ 合约代码      │
  ├──────────┼───────────────┤
  │ 标的名称 │ 合约名称      │
  ├──────────┼───────────────┤
  │ 多空     │ 多/空         │
  ├──────────┼───────────────┤
  │ 总持仓   │               │
  ├──────────┼───────────────┤
  │ 开仓均价 │               │
  ├──────────┼───────────────┤
  │ 开仓成本 │               │
  ├──────────┼───────────────┤
  │ 保证金   │               │
  ├──────────┼───────────────┤
  │ 手续费   │               │
  ├──────────┼───────────────┤
  │ 最新价   │               │
  ├──────────┼───────────────┤
  │ 合约价值 │               │
  ├──────────┼───────────────┤
  │ 浮动盈亏 │               │
  └──────────┴───────────────┘
  4.4 平仓记录（position_close_table）
  ┌──────┬─────────────────────┬──────────────┐
  │ 方法 │        路径         │     说明     │
  ├──────┼─────────────────────┼──────────────┤
  │ GET  │ /api/position-close │ 查询平仓记录 │
  └──────┴─────────────────────┴──────────────┘
  参数:
  - trade_date: 交易日期
  - account_name: 账号名称
  - position_name: 头寸名称
  - start_date: 开始日期
  - end_date: 结束日期
  - limit: 返回条数（默认1000，最大10000）

  返回字段:
  ┌──────────┬──────────┐
  │   字段   │   说明   │
  ├──────────┼──────────┤
  │ 交易日期 │          │
  ├──────────┼──────────┤
  │ 账号名称 │          │
  ├──────────┼──────────┤
  │ 资产类别 │          │
  ├──────────┼──────────┤
  │ 头寸类别 │          │
  ├──────────┼──────────┤
  │ 头寸名称 │          │
  ├──────────┼──────────┤
  │ 标的代码 │          │
  ├──────────┼──────────┤
  │ 标的名称 │          │
  ├──────────┼──────────┤
  │ 多空     │          │
  ├──────────┼──────────┤
  │ 总持仓   │ 平仓数量 │
  ├──────────┼──────────┤
  │ 开仓均价 │          │
  ├──────────┼──────────┤
  │ 开仓成本 │          │
  ├──────────┼──────────┤
  │ 保证金   │          │
  ├──────────┼──────────┤
  │ 手续费   │          │
  ├──────────┼──────────┤
  │ 平仓价格 │          │
  ├──────────┼──────────┤
  │ 合约价值 │          │
  ├──────────┼──────────┤
  │ 平仓盈亏 │          │
  ├──────────┼──────────┤
  │ 成交编号 │ 唯一键   │
  └──────────┴──────────┘
  ---
  五、基本面数据查询接口
  ┌──────┬──────────────────┬──────────────┐
  │ 方法 │       路径       │     说明     │
  ├──────┼──────────────────┼──────────────┤
  │ GET  │ /api/spot-prices │ 查询现货价格 │
  ├──────┼──────────────────┼──────────────┤
  │ GET  │ /api/inventory   │ 查询库存数据 │
  ├──────┼──────────────────┼──────────────┤
  │ GET  │ /api/spreads     │ 查询价差数据 │
  └──────┴──────────────────┴──────────────┘
  /api/spot-prices 参数:
  - product_code: 品种代码
  - region: 地区
  - trade_date, start_date, end_date, limit

  /api/inventory 参数:
  - product_code: 品种代码
  - inventory_type: 库存类型
  - region: 地区
  - trade_date, start_date, end_date, limit

  /api/spreads 参数:
  - product_code: 品种代码
  - spread_type: 价差类型
  - trade_date, start_date, end_date, limit

  ---
  六、回测系统接口

  6.1 写入接口（需认证）
  ┌──────┬──────────────────────┬──────────────┐
  │ 方法 │         路径         │     说明     │
  ├──────┼──────────────────────┼──────────────┤
  │ POST │ /api/backtest/task   │ 创建回测任务 │
  ├──────┼──────────────────────┼──────────────┤
  │ POST │ /api/backtest/log    │ 写入回测日志 │
  ├──────┼──────────────────────┼──────────────┤
  │ POST │ /api/backtest/result │ 写入回测结果 │
  └──────┴──────────────────────┴──────────────┘
  6.2 查询接口
  ┌──────┬───────────────────────┬──────────────────┐
  │ 方法 │         路径          │       说明       │
  ├──────┼───────────────────────┼──────────────────┤
  │ GET  │ /api/backtest/tasks   │ 查询回测任务列表 │
  ├──────┼───────────────────────┼──────────────────┤
  │ GET  │ /api/backtest/logs    │ 查询回测日志     │
  ├──────┼───────────────────────┼──────────────────┤
  │ GET  │ /api/backtest/results │ 查询回测结果     │
  └──────┴───────────────────────┴──────────────────┘
  参数: task_id, status, limit

  ---
  七、预警系统接口
  ┌──────┬─────────────────────┬────────────────────────┐
  │ 方法 │        路径         │          说明          │
  ├──────┼─────────────────────┼────────────────────────┤
  │ GET  │ /api/alerts/history │ 查询预警历史           │
  ├──────┼─────────────────────┼────────────────────────┤
  │ GET  │ /api/alerts/stats   │ 获取预警统计           │
  ├──────┼─────────────────────┼────────────────────────┤
  │ POST │ /api/alerts         │ 写入预警记录（需认证） │
  └──────┴─────────────────────┴────────────────────────┘
  /api/alerts/history 参数:
  - days: 查询天数，默认7，最大90
  - indicator_name: 指标名称
  - limit

  /api/alerts/stats 参数:
  - days: 统计天数，默认7

  ---
  八、系统日志接口
  ┌──────┬───────────┬──────────────┐
  │ 方法 │   路径    │     说明     │
  ├──────┼───────────┼──────────────┤
  │ GET  │ /api/logs │ 查询系统日志 │
  └──────┴───────────┴──────────────┘
  参数:
  - log_type: 日志类型
  - log_level: 日志级别
  - days: 查询天数，默认7
  - limit

  ---
  九、统计信息接口
  ┌──────┬────────────────────────┬──────────────────┐
  │ 方法 │          路径          │       说明       │
  ├──────┼────────────────────────┼──────────────────┤
  │ GET  │ /api/stats/summary     │ 获取系统概览统计 │
  ├──────┼────────────────────────┼──────────────────┤
  │ GET  │ /api/stats/performance │ 获取品种表现统计 │
  └──────┴────────────────────────┴──────────────────┘
  /api/stats/performance 参数:
  - symbol: 品种代码（必填）
  - days: 统计天数，默认30

  ---
  十、通用说明

  返回格式

  所有查询接口返回格式统一为：
  {
    "count": 100,
    "data": [...]
  }

  通用参数
  ┌────────────┬────────┬───────────────────────────────────┐
  │    参数    │  类型  │               说明                │
  ├────────────┼────────┼───────────────────────────────────┤
  │ limit      │ int    │ 返回条数限制，默认1000，最大10000 │
  ├────────────┼────────┼───────────────────────────────────┤
  │ trade_date │ string │ 交易日期，格式 YYYY-MM-DD         │
  ├────────────┼────────┼───────────────────────────────────┤
  │ start_date │ string │ 开始日期                          │
  ├────────────┼────────┼───────────────────────────────────┤
  │ end_date   │ string │ 结束日期                          │
  └────────────┴────────┴───────────────────────────────────┘
  认证方式

  写入接口需要在请求头中添加：
  Authorization: Bearer Market_Monitor_Secret_Key_2024

  ---
  十一、使用示例

  写入头寸持仓

  curl -X POST "http://100.75.102.44:8000/api/data/daily" \
    -H "Authorization: Bearer Market_Monitor_Secret_Key_2024" \
    -H "Content-Type: application/json" \
    -d '{
      "table": "position_table",
      "data": [{
        "交易日期": "2026-01-28",
        "账号名称": "账户A",
        "资产类别": "futures",
        "头寸类别": "对冲",
        "头寸名称": "多l-v",
        "标的代码": "l2505",
        "标的名称": "塑料2505",
        "多空": "多",
        "总持仓": 10,
        "开仓均价": 8500.0,
        "开仓成本": 85000.0,
        "保证金": 8500.0,
        "手续费": 50.0,
        "最新价": 8600.0,
        "合约价值": 86000.0,
        "浮动盈亏": 1000.0
      }]
    }'

  查询头寸持仓

  curl "http://100.75.102.44:8000/api/position?trade_date=2026-01-28&account_name=账户A"

  查询平仓记录

  curl "http://100.75.102.44:8000/api/position-close?start_date=2026-01-01&end_date=2026-01-31"

  查询期货账户

  curl "http://100.75.102.44:8000/api/futures/account?trade_date=2026-01-28"

  查询期货持仓

  curl "http://100.75.102.44:8000/api/futures/position?trade_date=2026-01-28"

  ---
  以上就是完整的 API 接口文档。
